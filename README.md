# CADET v.0.2.1
Concatemer by Amplification DEtection Tool V.0.2.1


Whole Genome Amplification using multiple displacement amplification (MDA) sometimes can introduce potential false concatemer sequences that can affect whole genome assembly assays. Here we propose a Concatemer detection tool for those WGA assays.

<p align="center">
  
<img width="350" height="350" alt="concatemer" src="https://user-images.githubusercontent.com/28576450/206510156-341b185c-b284-41a2-9937-484a46f24266.png">

</p>

**Figure. Concatemer-Mediated Multiple Displacement Amplification.** The principle of concatemer mediated multiple displacement amplification. 1-Religation of DNA fragments with T4 DNA ligase, which leads to two types of products, 2.1-Linear Concatemers and 2.2-Circular Concatemers. 3.1 and 3.2-Annealing of random hexamer primers and addition of phi29-DNA polymerase leads to concatemers-mediated multiple displacement amplification from linear and circular concatemers respectively. [Shoaib et al., 2008](https://bmcgenomics.biomedcentral.com/articles/10.1186/1471-2164-9-415).

## How it works?
It splits all reads in separate files to perform sliding windows with the user prefered size and the gap between these windows. For ONT amplified reads, we suggest windows >= 500bp with no overlaps (e.g. <window size> = 500 and <slide size> = 500). If the read is not able to generate more than one window (< 1kb in size in the 500bp window example) the read is skipped and its ID stored in the short.txt output file. Reads with more than two windows, will have their fragment windows aligned using nucmer and reads with overlaps are reported in stats and their IDs stored in the concat_ID output file. Statistics with the total number of reads, number of putative concatemers, number with no concatemer detection and the overlap frequency can be found in the stats.txt output.

  
### Workflow

  <p align="center">

<img width="500" height="500" alt="CADET_0 2 1" src="https://user-images.githubusercontent.com/28576450/206768044-3ed65ee6-b119-470c-bed7-a361d497efb4.png">

    
  </p>

## Instalation

Software Requirements:

- Mummer v3.23

- Seqtk v1.3

```
mamba create -n cadet -c bioconda -c conda-forge mummer seqtk 
```

## Usage
```
../CADET_v.0.2.1.sh [OPTIONS] -R <Reads.fastq> -w <window size> -s <slide size> -p <your_prefix>

Flag description:

Required:
  -R  --reads     fastq (or fasta*) file with reads generated by WGA sequencing using ONT (required)

Options: 
    -w  --window    length of desired window sequences in bp (required) (default = 500)
    -s  --slide     length to slide each window over in bp (required) (default = 500)
    -p  --prefix    Prefix name for your output folder (default = "CADET_output")  
    -h  --help      display this message

*Note: if using a FASTA file as input, the Concat.fastq output will be in fasta format
```

## Output Files
| Output File | Description |
| --- | --- |
|`concat_IDs`|sequence ID of putative concatemeric reads|
|`coords (folder)`| Folder with all nucmer coord alignments|
|`short.txt`| IDs of reads detected as short and skipped by the pipeline|
|`stats.txt`| File statistics of the CADET pipeline|
|`Non_conc.fastq`|fastq/fasta file containing non-concatemeric reads|
|`Conc.fastq`|fastq/fasta file containing putative concatemeric reads|
|`Short.fastq`|fastq/fasta file containing short reads|
